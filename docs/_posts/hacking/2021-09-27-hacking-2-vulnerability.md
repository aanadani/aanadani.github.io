---
layout: "content"
categories: computer-science hacking
title:     "التهكير الاخلاقي - الثغرات الالكترونية"
permalink: /:categories/:title.html
type: 'course'
---

<div class="page"><h1 class="title">الثغرات الإلكترونية </h1><br/><br /><br />ما هي الثغرة الأمنية (security bug) : هي نقاط الضعف الموجودة في انظمة التشغيل والتي تمكّن المهاجم من الدخول الى نظام التشغيل من خلالها ، فيصبح لديه القدرة لتدمير النظام نهائيا مثلا او التجسس على مستخدم الجهاز الآلي . <br />كيف تحدث الثغرات : سبب وجود الثغرات هو خطأ برمجي في سكربت او برنامج او كود <br /><br />ما هي أنواع الثغرات التي يمكن استغلالها ؟ <br />- ثغرات السيرفرات (أنظمة التشغيل)<br />- ثغرات البرامج<br />- ثغرات المواقع <br /><br />= ثغرات السيرفرات : وهي ثغرات في نظام تشغيل السيرفر او في برامج رئيسية تأتي مع السيرفر وهذا النوع يعد واحد من أخطر الثغرات لأنه على الاغلب ستؤدّي الى تغيير صلاحيات المستخدم او استخدام صلاحيات أعلى .<br /><br />- من اهم الامثلة على ثغرات السيرفرات هو الlocal privilege escalation وشرحها باختصار عندما يكتسب أحد المستخدمين (مستخدم عادي) صلاحيات مستخدم أعلى منه (ك صلاحيات الروت مثلا) وعادة تكون المشكلة في النواة (kernel) ، قد تظن ان هذه الثغرة قديمة لكن آخر اكتشاف لوجود هذه الثغرة كان في 2021-07-15 لنظام التشغيل linux kernel 2.6.19 &lt; 5.9 لمزيد من التفاصيل والكود المُستغل لهذه الثغرة : <br /> <a href="https://www.exploit-db.com/exploits/50135">https://www.exploit-db.com/exploits/50135</a><br /><img src="images/1-1.png" alt="images/1-1.png" /><br />= ثغرات البرامج : عبارة عن خطأ برمجي في كود البرنامج وإذا تم استغلال هذا الخطأ قد يؤدي لتمكين المخترق الى التحكم وتوجيه البرنامج لعمل أشياء معينة ، وخطورة البرنامج تكون بحسب وظيفته وصلاحيته في النظام . وطبعا كل ثغرة تختلف عن الأُخرى على حسب نوعها ومكان عملها ، فمثلا ثغرة بأحد البرامج التي تأخذ صلاحيات الروت او المسؤول سيمكّن المخترق من التصرف ك مسؤول او روت وبالتالي سيكون لديه صلاحيات لا محدودة . هناك بعض الامثلة على ثغرات البرامج وأشهرها ثغرة في الBuffer Overflow <br /><br />- لنتكلم قليلاً عن ال Buffer overflow : هي ثغرة تحدث عندما يتم كتابة بيانات اكثر من سعة المخزن - Buffer - ولا يتم التحقق من حجم البيانات المدخله <br /> فعلياً يكمن سبب حدوث الثغرة بسبب إستعمال دوال غير آمنة وهذه الدوال تتعامل مع الذاكرة ولكن لا تتحقق من حجم البيانات المدخله . وآخر ثغرات الBuffer overflow كانت في تاريخ 2021-08-18 لبرنامج crossfire-server 1.9.0 لمزيد من التفاصيل والاطّلاع على الكود البرمجي المُستغل لهذه الثغرة <a href="https://www.exploit-db.com/exploits/50216">https://www.exploit-db.com/exploits/50216</a><br /> <br /> <img src="images/1-2.png" alt="images/1-2.png" /><br /> <br />= ثغرات المواقع : هي أخطاء برمجية في سكريبت الخاص بالموقع ، يؤدي استغلال هذه الثغرة الى الحصول على معلومات من الموقع “والمحتمل ان تكون حساسة” ك ثغرة sql injection وبعضها تمكّن المخترق من السيطرة الجزئية على الموقع مما يؤدي الى التحكم بالموقع والسيطرة عليه (ثغرة الRCE) او الولوج الى ملفات السيرفر ك ثغرة الLFI او حتى رفع ملفات للسيرفر وتنفيذها (ك ثغرة الRFI)<br /><br />- واحدة من أخطر ثغرات مواقع الويب وهي حقن قواعد البيانات (sql injection) والثغرة عبارة عن قدرة المستخدم لإرسال نصوص برمجية queries الى قاعدة بيانات الموقع الالكتروني والهدف الحصول على معلومات حساسة غير متاحة للعامة . وهذه الثغرة خطيرة لأنه حتى لو كان السيرفر محميا جيدا يمكن ان تتسبب ب معرفة اسم المستخدمين وكلمات المرور الخاصة بهم ، سنتكلم بالتفصيل عن هذه الثغرة لاحقا<br /><img src="images/1-3.png" alt="images/1-3.png" /><br /><br />= ما هي الأدوات المستخدمة لفحص الثغرات الأمنية ؟ <br /><br />- نبدأ ب أداة مهمة لكل مخترق او مختبر اختراق : Nessus <br />هي ببساطة أداة تستخدم لكشف الثغرات الأمنية وتشمل الوصول عن بعد ورفض خدمات TCP/IP واكتشاف البرامج الضارة وبحث البيانات الحساسة وغيرها، وهي مدعومةٌ في نظامي لينكس بمختلف توزيعاته وويندوز.<br /><img src="images/1-4.png" alt="images/1-4.png" /><br /><br />- الأداة التالية : Metasploit<br /> هو مشروع يهتم في الثغرات الأمنية ويساعد في اختبارات الاختراق وتطوير أنظمة كشف التسللات. من مهام هذه الاداة قيامها بفتح منفذ في الجهاز المستهدف بهدف اختراقه. وأيضا تواجد معظم الاكواد البرمجية المُستغلة لنقاط الضعف الموجودة في البرامج المشهورة <br /> <img src="images/1-5.png" alt="images/1-5.png" /><br /><br /> - برنامج Acunetix : برنامج يقوم بمسح موقع الإنترنت ومعرفة الثغرات الموجودة فيه، تقوم هذه الأداة المتعددة المهام بالبحث ضمن الموقع وكشف البرامج النصية من المواقع الضارة وكشف الضرر الحاصل في SQL، ويمكنها أكتشاف أكثر من 1200 نقطة ضعفٍ محتملةٍ في مواقع WordPress، وهو يأتي بترتيب عملياتٍ يسمح بالوصول إلى المناطق المحمية بكلمة مرورٍ لمواقع الويب، وهو مخصصٌ لنظام ويندوز.<br /><br /><img src="images/1-6.png" alt="images/1-6.png" /><br /> <br /> -  اداة nikto لفحص المواقع من الثغرات والبورتات المفتوحة والأخطاء المشهورة في الاكواد البرمجية والمعلومات الاساسية عن الموقع . هذه الاداة مخصصة لمواقع الويب <br /><br /><img src="images/1-7.png" alt="images/1-7.png" /><br /><br />- أداة sqlmap : هي أداة مجانية  ومفتوحة المصدر للكشف عن ثغرات إدخال SQL واستغلالها. ولها ميزة رائعة ، وهي المعالجة الآلية للكشف والاستخدام (بصمة قاعدة البيانات ، والوصول إلى  نظام الملفات الأساسي ، وتنفيذ الأوامر). وتعد من أفضل الأدوات التي يستعملها الهاكر لحقن قواعد البيانات و جمع المعلومات داخلها ، وتعتبر من أفضل الأدوات الموجودة في توزيعة كالي لنكس ، وتمت برمجتها بلغة python ، ويمكن التغيير عليها لكونها مفتوحة المصدر <br /><img src="images/1-8.png" alt="images/1-8.png" /><br /><br /><br />= كيف يتم تطبيق اختراق الثغرات ؟<br /> يمكن تطبيق الثغرات بعدة اشكال او طرق ، تتشابه في المضمون وتختلف في الاسلوب . بالنسبة لثغرات المواقع تطبيقها يكون بشكل مباشر ، اي وضع رابط بعد عنوان الموقع واستغلال الثغرة ، أو بشكل اكسبلويت يتم تحميلها ثم تطبيقها واعطاءها متغيرات معينة وهي تقوم باداء العمل لوحدها . أما ثغرات السيرفرات في الاغلب تكون باكسبلويت ، والاكسبلويتات تكتب بأكثر من لغة وكتابتها تكون بحسب ما يرتاح الكاتب ،واللغات التي تكتب فيها الاكسبلويت تختلف بحسب المطلوب من الاكسبلويت . لاحقا سنرى مثال تطبيقي وتفصيلي عن اختراق إحدى الثغرات .</div>
