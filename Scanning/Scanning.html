<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Scanning</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
  <script></script>
</head>
<body><div class="page"><h1 class="title">Scanning</h1><br/><br /><br />سنتكلم اليوم عن واحدة من اهم مراحل الاختراق وهي الscanning ، طبعا الحديث سيكون من وجهة نظر أمنية بحتة <br /><br />• عملية ال scanning : هي عملية تهدف إلى ايجاد نقاط ضعف موجودة في نظام معيّن بواسطة التفاعل مع ذلك النظام <br /><br />• أهداف ال Scanning : <br />1) تحديد عناوين الشبكة (network addresses) للأنظمة النشطة <br />2) تحديد بنية الشبكة (network topology) الخاصة بالهدف : معرفة وجود جدران الحماية ، السيرفرات والclients ، الRouters والSwitches والأجهزة الأُخرى .. <br />3) تحديد أنواع أنظمة التشغيل للأنظمة التي تم إيجادها : لإيجاد الثغرات المرتبطة والمعروفة بنظام التشغيل .<br />4) تحديد ال (Ports) المفتوحة وخدمات الشبكة (Network services) عند الهدف : في هذه المرحلة يتم معرفة البورتات المفتوحة في الجهاز ولكن يجب معرفة انه هناك نوعين رئيسيين من البورتات : TCP و UDP . تذكّر انه كلما كان هناك بورتات أكثر كلما كان معرّضا للاختراق بنسبة أكبر لأن البورتات تمكنّك من الوصول الى جهاز الضحية . <br />5) إنشاء قائمة بالثغرات المحتمل وجودها : معرفة الثغرات ناتج عن معرفتنا ب نسخة الnetwork services مثلا إذا وجدت الضحية يملك web server والنسخة الخاصة به قديمة يمكنك البحث عن نسخة الweb server الخاص به في <a href="https://www.exploit-db.com/">https://www.exploit-db.com/</a> ، سنتحدث عن موضوع استغلال الثغرات لاحقا في موضوع مفصّل<br /><br /><br />• أقسام عملية الScanning :<br />1) قسم الnetwork sweeps : وهي معرفة هل الجهاز نشط أم خامل (غير نشط)<br />2) قسم الnetwork tracing : وهو معرفة الطريق بيني وبين الشيء المتصل به مثلا عدد الروترات التي أمر بها والIP الخاص بها وما الى ذلك ; لكي اعرف اين توجد المشكلة اذا انقطع الانترنت او الاتصال بيني وبين الهدف . <br />3) قسم ال Port Scans : معرفة عدد البورتات المفتوحة في الجهاز <br />4) قسم ال OS Fingerprinting : معرفة نظام التشغيل الخاص بالهدف <br />5) قسم ال version scans : معرفة نوعية الخدمات وأرقام إصدارها <br /><br />• أدوات ال Scanning <br />         - واحدة من أهم أدوات الscanning هي الnmap بلا شك ; لأنها قادرة على فعل أهداف وأقسام الscanning الخمس التي تم ذكرهم سابقا <br />    <br />         <img src="images/1-1.png" alt="images/1-1.png" /><br />         <br />         الآن سنبدأ بتطبيق الأقسام الخمس التي تم ذكرهم سابقا بواسطة ال nmap لكن قبل ذلك يجب معرفة ان الnmap عبارة عن سكريبتات جاهزة مكتوبة بلغة البرمجة Lua<br />1) معرفة هل الجهاز نشط أم لا : سنستخدم الامر nmap -sP IP-TARGET <br /><img src="images/1-2.png" alt="images/1-2.png" /><br />كما هو واضح الأجهزة التالية نشطة 192.168.0.1 , 192.168.0.45 , 192.168.0.122 , 192.168.0.199 , 192.168.0.66<br />2) معرفة الطريق بيني وبين الهدف وكم عدد الhops نستخدم اداة traceroute6 : <br /><img src="images/1-3.png" alt="images/1-3.png" /><br /><br />3) معرفة عدد البورتات المفتوحة عند الهدف نستخدم الأمر : nmap -p 0-65535 IP-TARGET<br />خيار ال -p لاختيار البورتات المراد فحصها ولأننا سنفحص نطاق معيّن من البورتات ، ليس واحد او اثنين سنستخدم - مع اصغر قيمة الى اكبر قيمة ف مثلا اذا اردنا فحص البورتات من 1 الى 100 سنستخدم الامر 1-100 مع الp- . وبما أننا اردنا فحص كل البورتات وكل البورتات الموجودة 65535 سنبدأ من البورت 0 الى البورت 65535 كما هو موضّح في الصورة : <br /><img src="images/1-4.png" alt="images/1-4.png" /><br />والنتائج كما هي واضحة هناك بورت 22 ومُستخدم من قبل الssh ، وبورت 80 مُستخدم من قبل الhttp بمعنى انه هناك ويب سيرفر . وبورت 8765 أيضا مستخدم من ويب سيرفر<br /><br />4) الآن حان وقت معرفة نظام تشغيل الخاص بالهدف ، سنستخدم الnmap مع أمر O- كما هو موضّح في المثال : <br /><img src="images/1-5.png" alt="images/1-5.png" /><br />طبعا نتائج البحث أتت متطابقة وهي ان نظام التشغيل لينكس ، ولكن لتشابه الرد المُستقبل من الضحية أعطانا الnmap عدّة أنظمة تشغيل مع احتمالية صحّتها ف نسبة ان يكون crestron XPanel control system 90% و لينكس 1.10-3.13 89% وهكذا <br /><br />5) معرفة ال version services : سنستخدم الnmap بالأمر التالي : nmap -sV -p 80,22,8765 IP-TARGET<br />الفكرة الجديدة هنا استخدامنا للsV- وتعني scan version مع البورتات التي تم اكتشافهم مسبقا . ونتائج العملية كالآتي :<br /><img src="images/1-6.png" alt="images/1-6.png" /> <br />المحصّلة كانت معرفة إصدار برامج الservices الموجودة على نظام المُستهدف ف مثلا الويب سيرفر الخاص به يستخدم nginx 1.10.3 و Apache 2.4.18 <br /><br />الScanning واحدة من أهم المراحل في تنفيذ الاختراق ف كلمّا كان لديك معلومات عن الضحية اكثر كلما كان اختراقها لاحقا أسهل . أما بالنسبة للأدوات هناك العديد منها مثل masscan , rustscan وأهمها الnmap . هناك حاﻻت يمنع فيها الfirewall هذه الأدوات من معرفة بعض المعلومات ولكن يمكن أيضا تجاوز حمايته . </div></body></html>